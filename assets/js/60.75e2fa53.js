(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{479:function(s,a,t){"use strict";t.r(a);var n=t(23),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一、用户的创建、删除与修改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、用户的创建、删除与修改"}},[s._v("#")]),s._v(" 一、用户的创建、删除与修改")]),s._v(" "),t("h4",{attrs:{id:"创建用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用户"}},[s._v("#")]),s._v(" "),t("strong",[s._v("创建用户")])]),s._v(" "),t("p",[s._v("首先要进入我们的admin库中，进入方法是直接使用"),t("code",[s._v("use admin")]),s._v(" 就可以。进入后可以使用"),t("code",[s._v("show collections")]),s._v("来查看数据库中的集合。默认是只有一个集合的（system.version）。")]),s._v(" "),t("p",[s._v("创建用户可以用"),t("code",[s._v("db.createUser")]),s._v("方法来完成，参数可参考"),t("a",{attrs:{href:"https://docs.mongodb.com/manual/tutorial/create-users/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jspang"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    pwd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    customData"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'技术胖'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        email"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web0432@126.com'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        age"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    roles"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'read'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("当然我们还可以单独配置一个数据库的权限，比如我们现在要配置"),t("code",[s._v("compay")]),s._v("数据库的权限为读写：")]),s._v(" "),t("div",{staticClass:"language-css line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-css"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("db.createUser(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v('user:"jspang",\n    pwd:"123456",\n    customData:')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'技术胖'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("email")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web0432@126.com'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("age")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("18"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v(",\n    roles:[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("role")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"readWrite"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("db")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"company"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'read'")]),s._v("\n    ]\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h4",{attrs:{id:"内置角色"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内置角色"}},[s._v("#")]),s._v(" "),t("strong",[s._v("内置角色")]),s._v("：")]),s._v(" "),t("ol",[t("li",[s._v("数据库用户角色：read、readWrite；")]),s._v(" "),t("li",[s._v("数据库管理角色：dbAdmin、dbOwner、userAdmin;")]),s._v(" "),t("li",[s._v("集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManage；")]),s._v(" "),t("li",[s._v("备份恢复角色：backup、restore；")]),s._v(" "),t("li",[s._v("所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase")]),s._v(" "),t("li",[s._v("超级用户角色：root")]),s._v(" "),t("li",[s._v("内部角色：__system")])]),s._v(" "),t("p",[t("strong",[s._v("1、数据库用户角色")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("read:该角色拥有数据的只读权限，系统集合以及system.indexes,system.js,system.namespaces集合除外。")])]),s._v(" "),t("li",[t("p",[s._v("readWrite:该角色拥有对应数据库的读写权限，系统集合和system.js集合除外。")])])]),s._v(" "),t("p",[t("strong",[s._v("2、数据库管理角色")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("dbAdmin:该角色拥有指定数据库数据库管理权限，包括 system.indexes, system.namespaces, system.profile集合的操作权限。该角色不拥有所有非系统集合的读权限。")])]),s._v(" "),t("li",[t("p",[s._v("dbOwner:该角色拥有指定数据库的所有权限，该角色包括：readWrite、dbAdmin、userAdmin。")])]),s._v(" "),t("li",[t("p",[s._v("userAdmin:该角色拥有指定数据库用户和角色的管理权限。包括创建用户等。")])])]),s._v(" "),t("p",[t("strong",[s._v("3、群集管理角色")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("clusterAdmin:该角色拥有群集的所有权限。该角色包含clusterManager,clusterMonitor,hostManager 角色权限。同时还要删除数据库的权限。")])]),s._v(" "),t("li",[t("p",[s._v("clusterManager:该角色拥有群集的管理和监控权限，包括对local、config数据库的访问权限。同时该角色拥有分片和复制集的管理权限。")])]),s._v(" "),t("li",[t("p",[s._v("clusterMonitor:该角色拥有群集的监控权限。")])]),s._v(" "),t("li",[t("p",[s._v("hostManager:该角色拥有群集的监控和服务管理权限。")])])]),s._v(" "),t("p",[s._v("注意：这些角色只能在Admin数据库下创建")]),s._v(" "),t("p",[t("strong",[s._v("4、备份还原角色")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("backup:该角色拥有备份数据的权限。")])]),s._v(" "),t("li",[t("p",[s._v("restore:该角色拥有还原备份数据的权限。")])])]),s._v(" "),t("p",[s._v("注意：这些角色只能在Admin数据库下创建")]),s._v(" "),t("p",[t("strong",[s._v("5、所有数据库角色")])]),s._v(" "),t("p",[s._v("该分类下面的角色权限和数据库角色权限一样，区别在于它拥有的是所有数据库的权限而不是指定数据库下的权限。但是不拥有system.*相关集合、local、config数据库的权限。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("readAnyDatabase")])]),s._v(" "),t("li",[t("p",[s._v("readWriteAnyDatabase")])]),s._v(" "),t("li",[t("p",[s._v("userAdminAnyDatabase")])]),s._v(" "),t("li",[t("p",[s._v("dbAdminAnyDatabase")])])]),s._v(" "),t("p",[s._v("注意：这些角色只能在Admin数据库下创建")]),s._v(" "),t("p",[t("strong",[s._v("6、超级权限角色")])]),s._v(" "),t("ul",[t("li",[s._v("root:该角色拥有所有权限,该角色包含readWriteAnyDatabase, dbAdminAnyDatabase, userAdminAnyDatabase, clusterAdmin roles, restore, and backup角色。")])]),s._v(" "),t("p",[s._v("注意：该角色只能在创建在Admin库中")]),s._v(" "),t("p",[s._v("**7、内部角色 **")]),s._v(" "),t("ul",[t("li",[s._v("__system:该角色为系统内部角色，比如复制集成员、mongos使用。")])]),s._v(" "),t("h4",{attrs:{id:"查找用户信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查找用户信息"}},[s._v("#")]),s._v(" 查找用户信息")]),s._v(" "),t("p",[s._v("我们直接可以使用查找的方法，查找用户信息。命令很简单：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("db.system.users.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndb.system.users.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".pretty"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"删除用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除用户"}},[s._v("#")]),s._v(" 删除用户：")]),s._v(" "),t("p",[s._v("删除名利也是非常简单，直接用remove就可以删除这个用户的信息和权限。")]),s._v(" "),t("div",{staticClass:"language-css line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-css"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("db.system.users.remove(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jspang"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"建权"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#建权"}},[s._v("#")]),s._v(" "),t("strong",[s._v("建权")])]),s._v(" "),t("p",[s._v("有时候我们要验证用户的用户名密码是否正确，就需要用到MongoDB提供的健全操作。也算是一种登录操作，不过MongoDB把这叫做建权。")]),s._v(" "),t("div",{staticClass:"language-less line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-less"}},[t("code",[s._v("db."),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("auth")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jspang"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果正确返回1，如果错误返回0。（Error：Authentication failed。）")]),s._v(" "),t("h4",{attrs:{id:"启动建权"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动建权"}},[s._v("#")]),s._v(" "),t("strong",[s._v("启动建权")])]),s._v(" "),t("p",[s._v("重启MongoDB服务器，然后设置必须使用建权登录。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mongod --auth\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("启动后，用户登录只能用用户名和密码进行登录，原来的mongo形式链接已经不起作用了。相应的用户权限也对应妥当。实际项目中我们启动服务器必须使用建权形式。")]),s._v(" "),t("h4",{attrs:{id:"登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[s._v("#")]),s._v(" "),t("strong",[s._v("登录")])]),s._v(" "),t("p",[s._v("如果在配置用户之后，用户想登录，可以使用mongo的形式，不过需要配置用户名密码：")]),s._v(" "),t("div",{staticClass:"language-dns line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("mongo -u jspang -p 123456 127.0.0.1:27017/admin\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这时候我们就可以用给我们的权限对数据库操作了。")]),s._v(" "),t("h4",{attrs:{id:"密码管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码管理"}},[s._v("#")]),s._v(" 密码管理")]),s._v(" "),t("p",[t("strong",[s._v("修改密码")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("db.updateUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(",\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      pwd: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc"')]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"二、备份和还原"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、备份和还原"}},[s._v("#")]),s._v(" 二、备份和还原")]),s._v(" "),t("p",[s._v("安装mongodb后若安装目录bin文件夹中无数据备份和恢复工具，则需单独下载对应补充工具。"),t("a",{attrs:{href:"https://www.mongodb.com/try/download/database-tools",target:"_blank",rel:"noopener noreferrer"}},[s._v("database-tools"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_8.png",alt:""}})]),s._v(" "),t("h4",{attrs:{id:"数据备份"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据备份"}},[s._v("#")]),s._v(" "),t("strong",[s._v("数据备份")])]),s._v(" "),t("p",[s._v("先来看一下"),t("code",[s._v("mongodump")]),s._v("备份的基本格式，其实这就是条在终端中执行的命令。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mongodump\n    -h                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务器IP地址127.0.0.1（一般不写，默认本机）")]),s._v("\n    -port                           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#端口（一般不写，默认27017） ")]),s._v("\n    -u                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#user账号")]),s._v("\n    -p                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#password密码")]),s._v("\n    -d                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指明database数据库名（数据库不写则导出全部数据库）")]),s._v("\n    -c                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指明collection的名字")]),s._v("\n    -o                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#open备份至指定目录中")]),s._v("\n    -q                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指明导出数据的过滤条件")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ul",[t("li",[s._v("备份全部数据库")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认无账户")]),s._v("\nmongodump -o D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodump\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份所有MongoDB里的库到E盘的mongodb/bak文件夹下")]),s._v("\nmongodump -u root -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" -o e:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bak\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("备份指定数据库")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认")]),s._v("\nmongodump -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:27017 -d shop -o D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodump\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份shop数据库")]),s._v("\nmongodump -u shop2 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" -d shop -o e:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bak\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"数据恢复"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据恢复"}},[s._v("#")]),s._v(" 数据恢复")]),s._v(" "),t("p",[s._v("备份好后，如果数据库有意外或者遭受到了攻击，我们要进行回复数据库，这时候就可以使用"),t("code",[s._v("mongorestore")]),s._v("命令。")]),s._v(" "),t("p",[s._v("还是先看一下它的基本格式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mongorestore\n    -h                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 127.0.0.1")]),s._v("\n    -port                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 27017")]),s._v("\n    -u                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# user")]),s._v("\n    -p                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# password")]),s._v("\n    -d                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不写则还原全部数据库")]),s._v("\n    --drop                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先删除数据库再导入")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份数据库目录")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("比如我们现在不小心删除了一个collections的数据，要进行恢复。现在删除"),t("code",[s._v("randomInfo")]),s._v("集合。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("db.randomInfo.drop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("恢复全部数据")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mongorestore D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodump\n\nmongorestore -u root -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" --drop e:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bak\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[s._v("恢复指定数据")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mongorestore -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:27017 -d shop --dir D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodump"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("shop\n\nmongorestore -u shop2 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" -d shop --drop e:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mongodb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bak"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("shop\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"mongo权限机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mongo权限机制"}},[s._v("#")]),s._v(" mongo权限机制")]),s._v(" "),t("h3",{attrs:{id:"开启验证模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开启验证模式"}},[s._v("#")]),s._v(" 开启验证模式")]),s._v(" "),t("p",[s._v("即需输入账户/密码才可登录使用。")]),s._v(" "),t("p",[t("strong",[s._v("操作步骤")])]),s._v(" "),t("p",[s._v("步骤1：添加超级管理员")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mongo\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use admin\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.createUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    user: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(",\n    pwd: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(",\n    roles: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        role: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(",       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 角色")]),s._v("\n        db: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 所属数据库")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("步骤2：退出卸载服务")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("C:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Program Files"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("MongoDB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("mongod --remove\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_1.png",alt:""}})]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("cmd命令窗口需以管理员身份打开")])]),s._v(" "),t("p",[s._v("步骤3：重新安装需要身份验证的mongodb服务")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("C:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Program Files"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("MongoDB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("mongod --install --dbpath "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\Program Files\\MongoDB\\Server'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\4"}},[s._v("\\4")]),s._v('.4\\data"')]),s._v(" --logpath "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\Program Files\\MongoDB\\Server'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\4"}},[s._v("\\4")]),s._v('.4\\log\\mongod2.log"')]),s._v(" --auth\n\nC:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Program Files"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("MongoDB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("net start mongodb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_2.png",alt:""}})]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("1、cmd命令窗口需以管理员身份打开\n2、log日志文件不能重名，需重新新建一个")])]),s._v(" "),t("p",[s._v("步骤4：启动服务，测试登录效果")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_3.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"通过超级管理员账号登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过超级管理员账号登录"}},[s._v("#")]),s._v(" 通过超级管理员账号登录")]),s._v(" "),t("ul",[t("li",[s._v("方法1")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mongo 服务器IP地址:端口/数据库 -u 用户名 -p 密码")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mongo "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:27017/admin -u root -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_4.png",alt:""}})]),s._v(" "),t("ul",[t("li",[s._v("方法2")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先登录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再选择数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入 db.auth(name, password)")]),s._v("\n\ndb.auth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_5.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"练习"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[s._v("#")]),s._v(" 练习")]),s._v(" "),t("ul",[t("li",[s._v("需求")])]),s._v(" "),t("p",[s._v("1、添加shop1可以读shop数据库\n2、添加shop2可以读写shop数据库")]),s._v(" "),t("ul",[t("li",[s._v("准备（创建测试数据）")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("use shop\n\nfor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("var i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i++"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    db.goods.insert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"goodsName"')]),s._v(" + i, "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ndb.goods.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("ul",[t("li",[s._v("添加用户并设置权限")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("use shop\n\ndb.createUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    user: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shop1"')]),s._v(",\n    pwd: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(",\n    roles: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        role: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'read'")]),s._v(",\n        db: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shop'")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndb.createUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    user: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shop2"')]),s._v(",\n    pwd: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(",\n    roles: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        role: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'readWrite'")]),s._v(",\n        db: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shop'")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[t("code",[s._v("use shop")]),s._v("进入shop数据库创建用户，但是数据还是存储在admin数据库中。")])]),s._v(" "),t("ul",[t("li",[s._v("验证用户权限（shop1只能读）")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mongo localhost:27017/shop -u shop1 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show collections\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.goods.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.goods.insert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"测试新增一条数据"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 错误（该用户权限只能读）")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_6.png",alt:""}})]),s._v(" "),t("ul",[t("li",[s._v("验证用户权限（shop2可读可写）")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mongo localhost:27017/shop -u shop2 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show collections\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.goods.find"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.goods.insert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"测试新增一条数据"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/leijialin/noteImages/notes/mongodb/06_7.png",alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);